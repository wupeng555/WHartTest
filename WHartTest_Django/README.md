# WhartTest - AIé©±åŠ¨çš„æ™ºèƒ½æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå¹³å°

## é¡¹ç›®ç®€ä»‹

WhartTest æ˜¯ä¸€ä¸ªåŸºäº Django REST Framework æ„å»ºçš„AIé©±åŠ¨æµ‹è¯•è‡ªåŠ¨åŒ–å¹³å°ï¼Œæ ¸å¿ƒåŠŸèƒ½æ˜¯é€šè¿‡AIæ™ºèƒ½ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ã€‚å¹³å°é›†æˆäº† LangChainã€MCPï¼ˆModel Context Protocolï¼‰å·¥å…·è°ƒç”¨ã€é¡¹ç›®ç®¡ç†ã€æµ‹è¯•ç”¨ä¾‹ç®¡ç†ä»¥åŠå…ˆè¿›çš„çŸ¥è¯†åº“ç®¡ç†å’Œæ–‡æ¡£ç†è§£åŠŸèƒ½ã€‚åˆ©ç”¨å¤§è¯­è¨€æ¨¡å‹å’ŒHuggingFaceåµŒå…¥æ¨¡å‹çš„èƒ½åŠ›ï¼Œè‡ªåŠ¨åŒ–ç”Ÿæˆé«˜è´¨é‡çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå¹¶ç»“åˆçŸ¥è¯†åº“æä¾›æ›´ç²¾å‡†çš„æµ‹è¯•è¾…åŠ©ï¼Œä¸ºæµ‹è¯•å›¢é˜Ÿæä¾›ä¸€ä¸ªå®Œæ•´çš„æ™ºèƒ½æµ‹è¯•ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¤– AIæ™ºèƒ½æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
- åŸºäºå¤§è¯­è¨€æ¨¡å‹çš„æ™ºèƒ½æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ç”Ÿæˆ
- æ”¯æŒå¤šç§ LLM ä¾›åº”å•†ï¼ˆOpenAIã€Anthropicã€Claude ç­‰ï¼‰ï¼Œå¯çµæ´»é…ç½®
- é€šè¿‡ MCP å·¥å…·è°ƒç”¨ï¼Œå®ç°æµ‹è¯•ç”¨ä¾‹çš„æ™ºèƒ½åˆ†æå’Œç”Ÿæˆï¼Œæ”¯æŒè‡ªå®šä¹‰å·¥å…·é›†
- è‡ªç„¶è¯­è¨€æè¿°è½¬æ¢ä¸ºç»“æ„åŒ–æµ‹è¯•ç”¨ä¾‹ï¼Œç»“åˆçŸ¥è¯†åº“æå‡å‡†ç¡®æ€§
- æ”¯æŒæµ‹è¯•æ­¥éª¤ã€é¢„æœŸç»“æœçš„è‡ªåŠ¨ç”Ÿæˆï¼Œå¹¶å¯è¿›è¡ŒAIè¾…åŠ©ä¼˜åŒ–
- æ”¯æŒå¤šç§åµŒå…¥æœåŠ¡ï¼ˆOpenAIã€Azure OpenAIã€Ollamaç­‰ï¼‰ï¼Œå¢å¼ºè¯­ä¹‰ç†è§£

### ğŸ’¬ æ™ºèƒ½å¯¹è¯ç³»ç»Ÿ
- åŸºäº LangChain å’Œ LangGraph çš„ AI å¯¹è¯åŠŸèƒ½
- æ”¯æŒæµå¼å“åº”å’ŒèŠå¤©å†å²ç®¡ç†
- ä¸æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæ·±åº¦é›†æˆ

### ğŸ“‹ é¡¹ç›®ç®¡ç†
- å¤šé¡¹ç›®æ”¯æŒï¼Œå®ç°æ•°æ®éš”ç¦»
- åŸºäºè§’è‰²çš„æƒé™æ§åˆ¶ï¼ˆOwnerã€Adminã€Memberï¼‰
- é¡¹ç›®æˆå‘˜ç®¡ç†å’Œæƒé™åˆ†é…
- é¡¹ç›®çº§åˆ«çš„èµ„æºè®¿é—®æ§åˆ¶

### ğŸ§ª æ™ºèƒ½æµ‹è¯•ç”¨ä¾‹ç®¡ç†
- AIç”Ÿæˆçš„æµ‹è¯•ç”¨ä¾‹è‡ªåŠ¨ä¿å­˜å’Œç®¡ç†
- å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹ CRUD æ“ä½œ
- æ”¯æŒç”¨ä¾‹æ¨¡å—åˆ†ç±»ç®¡ç†
- åµŒå¥—å¼ç”¨ä¾‹æ­¥éª¤ç®¡ç†
- ç”¨ä¾‹å¯¼å‡ºåŠŸèƒ½ï¼ˆExcel æ ¼å¼ï¼‰
- åŸºäºé¡¹ç›®çš„ç”¨ä¾‹éš”ç¦»
- æµ‹è¯•ç”¨ä¾‹è´¨é‡è¯„ä¼°å’Œä¼˜åŒ–å»ºè®®
- ä¸çŸ¥è¯†åº“è”åŠ¨ï¼Œç”Ÿæˆæ›´è´´åˆä¸šåŠ¡åœºæ™¯çš„æµ‹è¯•ç”¨ä¾‹

### ğŸ”§ MCP å·¥å…·é›†æˆ
- æ”¯æŒå¤šç§ MCP ä¼ è¾“æ–¹å¼ï¼ˆstdioã€HTTPã€SSEï¼‰
- è¿œç¨‹ MCP æœåŠ¡å™¨è¿æ¥
- å·¥å…·è°ƒç”¨æ—¥å¿—å’Œç›‘æ§
- ä¸ AI æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆç³»ç»Ÿæ·±åº¦é›†æˆ
- æä¾›æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆä¸“ç”¨å·¥å…·é›†

### ğŸ§  çŸ¥è¯†åº“ç®¡ç†
- æ”¯æŒåˆ›å»ºå’Œç®¡ç†å¤šä¸ªçŸ¥è¯†åº“ï¼ŒåŸºäºé¡¹ç›®éš”ç¦»
- æ–‡æ¡£å¯¼å…¥ä¸è‡ªåŠ¨åˆ†ç‰‡ã€å‘é‡åŒ–å¤„ç†ï¼ˆæ”¯æŒPDF, DOCX, TXTç­‰å¤šç§æ ¼å¼ï¼‰
- å¤šç§åµŒå…¥æœåŠ¡æ”¯æŒï¼šOpenAIã€Azure OpenAIã€Ollama
- åŸºäºè¯­ä¹‰çš„é«˜æ•ˆæ£€ç´¢å’Œç›¸ä¼¼åº¦åŒ¹é…
- ä¸AIå¯¹è¯å’Œæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæ·±åº¦é›†æˆï¼Œæä¾›ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›
- çŸ¥è¯†åº“å†…å®¹ç®¡ç†ä¸æ›´æ–°

### ğŸ”§ MCP å·¥å…·é›†æˆ
- æ”¯æŒå¤šç§ MCP ä¼ è¾“æ–¹å¼ï¼ˆstdioã€HTTPã€SSEï¼‰
- è¿œç¨‹ MCP æœåŠ¡å™¨è¿æ¥
- å·¥å…·è°ƒç”¨æ—¥å¿—å’Œç›‘æ§
- ä¸ AI æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆç³»ç»Ÿæ·±åº¦é›†æˆ
- æä¾›æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆä¸“ç”¨å·¥å…·é›†

### ï¿½ å®‰å…¨è®¤è¯
- JWT ä»¤ç‰Œè®¤è¯
- API Key è®¤è¯æ”¯æŒ
- ç»†ç²’åº¦æƒé™æ§åˆ¶
- ç”¨æˆ·å’Œç»„ç®¡ç†

## æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Django 5.2.1 + Django REST Framework
- **æ•°æ®åº“**: SQLiteï¼ˆå¼€å‘ï¼‰/ PostgreSQLï¼ˆç”Ÿäº§ï¼‰
- **è®¤è¯**: JWT + API Key åŒé‡è®¤è¯
- **AIå¼•æ“**: LangChain + LangGraphï¼ˆæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæ ¸å¿ƒï¼‰
- **çŸ¥è¯†åº“å¼•æ“**: LangChain + ChromaDB + å¤šç§åµŒå…¥æœåŠ¡ï¼ˆOpenAI/Azure/Ollamaç­‰ï¼‰
- **MCPé›†æˆ**: FastMCP + langchain-mcp-adaptersï¼ˆå·¥å…·è°ƒç”¨ï¼‰
- **APIæ–‡æ¡£**: drf-spectacular (OpenAPI 3.0)
- **ç¯å¢ƒå˜é‡ç®¡ç†**: python-dotenv

### æ ¸å¿ƒä¾èµ–
```
# æ ¸å¿ƒæ¡†æ¶ä¸WebæœåŠ¡
django==5.2.1
djangorestframework
djangorestframework-simplejwt
drf-spectacular
django-cors-headers
python-dotenv
gunicorn # ç”Ÿäº§ç¯å¢ƒWSGIæœåŠ¡å™¨

# AIä¸LangChainç›¸å…³
langchain-core
langchain-openai
langchain-community # åŒ…å«å¤šç§LLMé›†æˆå’Œå·¥å…·
langgraph
langgraph-checkpoint-sqlite # LangGraphçŠ¶æ€æŒä¹…åŒ–
fastmcp>=2.3.0
langchain-mcp-adapters

# çŸ¥è¯†åº“ç›¸å…³
langchain-text-splitters
langchain-chroma # ChromaDBå‘é‡æ•°æ®åº“é›†æˆ
# æ³¨æ„ï¼šç°ä½¿ç”¨CustomAPIEmbeddingsé€šè¿‡APIè°ƒç”¨åµŒå…¥æ¨¡å‹ï¼Œæ— éœ€ä»¥ä¸‹æœ¬åœ°æ¨¡å‹ä¾èµ–
# langchain-huggingface # HuggingFaceåµŒå…¥æ¨¡å‹æ”¯æŒ (å·²å¼ƒç”¨)
# sentence-transformers # HuggingFaceå¥å­è½¬æ¢æ¨¡å‹ (å·²å¼ƒç”¨ï¼Œçº¦1GB+)
# torch # PyTorch (å·²å¼ƒç”¨ï¼Œçº¦800MB+)
# transformers # HuggingFace Transformersåº“ (å·²å¼ƒç”¨)
# huggingface-hub # HuggingFaceæ¨¡å‹ä¸‹è½½ (å·²å¼ƒç”¨)

# æ–‡æ¡£å¤„ç†
pypdf
python-docx
python-pptx
docx2txt
unstructured
beautifulsoup4 # HTMLè§£æ

# æ•°æ®åº“ä¸å·¥å…·
django-filter # DRFåˆ—è¡¨è¿‡æ»¤
drf-nested-routers # DRFåµŒå¥—è·¯ç”±
openpyxl # Excelå¯¼å‡º
httpx # HTTPå®¢æˆ·ç«¯ (ä¾‹å¦‚è°ƒç”¨å¤–éƒ¨API)
openai # OpenAIå®˜æ–¹SDK
# psycopg2-binary # PostgreSQLé©±åŠ¨ (ç”Ÿäº§ç¯å¢ƒå¯é€‰)
```

## åº”ç”¨æ¨¡å—

### 1. accounts - ç”¨æˆ·ç®¡ç†
- ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†
- ç”¨æˆ·ç»„å’Œæƒé™åˆ†é…
- JWT ä»¤ç‰Œç®¡ç†

### 2. projects - é¡¹ç›®ç®¡ç†
- é¡¹ç›® CRUD æ“ä½œ
- é¡¹ç›®æˆå‘˜ç®¡ç†
- åŸºäºé¡¹ç›®çš„æƒé™æ§åˆ¶

### 3. testcases - æµ‹è¯•ç”¨ä¾‹ç®¡ç†
- æµ‹è¯•ç”¨ä¾‹å’Œç”¨ä¾‹æ­¥éª¤ç®¡ç†
- ç”¨ä¾‹æ¨¡å—åˆ†ç±»
- ç”¨ä¾‹å¯¼å‡ºåŠŸèƒ½

- ç”¨ä¾‹å¯¼å‡ºåŠŸèƒ½

### 4. knowledge - çŸ¥è¯†åº“ç®¡ç† (æ–°å¢)
- çŸ¥è¯†åº“ CRUD æ“ä½œ
- æ–‡æ¡£ä¸Šä¼ ã€å‘é‡åŒ–å¤„ç†ä¸ç´¢å¼•æ„å»º
- çŸ¥è¯†åº“å†…å®¹æ£€ç´¢ä¸ç®¡ç†
- ä¸AIå¯¹è¯ã€æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæ¨¡å—è”åŠ¨

### 5. langgraph_integration - AIæµ‹è¯•ç”¨ä¾‹ç”Ÿæˆå¼•æ“
- LLM é…ç½®ç®¡ç†
- AI æ™ºèƒ½æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
- è‡ªç„¶è¯­è¨€åˆ°æµ‹è¯•ç”¨ä¾‹çš„è½¬æ¢
- AI å¯¹è¯æ¥å£
- èŠå¤©å†å²ç®¡ç†
- æµå¼å“åº”æ”¯æŒ

- æµå¼å“åº”æ”¯æŒ

### 6. mcp_tools - MCP å·¥å…·ç®¡ç†
- MCP æœåŠ¡å™¨é…ç½®
- å·¥å…·è°ƒç”¨ç®¡ç†
- è¿œç¨‹ MCP è¿æ¥

- è¿œç¨‹ MCP è¿æ¥

### 7. api_keys - API å¯†é’¥ç®¡ç†
- LLM ä¾›åº”å•† API å¯†é’¥ç®¡ç†
- API Key è®¤è¯æ”¯æŒ

## API æ¥å£

### è®¤è¯æ¥å£
- `POST /api/token/` - è·å– JWT ä»¤ç‰Œ
- `POST /api/token/refresh/` - åˆ·æ–° JWT ä»¤ç‰Œ

### ç”¨æˆ·ç®¡ç†
- `GET /api/accounts/users/` - ç”¨æˆ·åˆ—è¡¨
- `POST /api/accounts/register/` - ç”¨æˆ·æ³¨å†Œ
- `GET /api/accounts/me/` - å½“å‰ç”¨æˆ·ä¿¡æ¯

### é¡¹ç›®ç®¡ç†
- `GET /api/projects/` - é¡¹ç›®åˆ—è¡¨
- `POST /api/projects/` - åˆ›å»ºé¡¹ç›®
- `GET /api/projects/{id}/` - é¡¹ç›®è¯¦æƒ…
- `POST /api/projects/{id}/add_member/` - æ·»åŠ æˆå‘˜

### æµ‹è¯•ç”¨ä¾‹ç®¡ç†
- `GET /api/projects/{project_id}/testcases/` - ç”¨ä¾‹åˆ—è¡¨
- `POST /api/projects/{project_id}/testcases/` - åˆ›å»ºç”¨ä¾‹
- `GET /api/projects/{project_id}/testcases/{id}/` - ç”¨ä¾‹è¯¦æƒ…
- `GET /api/projects/{project_id}/testcase-modules/` - é¡¹ç›®çš„ç”¨ä¾‹æ¨¡å—åˆ—è¡¨
- `POST /api/projects/{project_id}/testcase-modules/` - ä¸ºé¡¹ç›®åˆ›å»ºç”¨ä¾‹æ¨¡å—

### AI æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
- `POST /api/lg/chat/` - AI æ™ºèƒ½ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹
- `POST /api/lg/chat/stream/` - æµå¼æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ
- `GET /api/lg/chat/history/` - ç”Ÿæˆå†å²è®°å½•

### MCP å·¥å…·
- `GET /api/mcp_tools/configs/` - MCP é…ç½®åˆ—è¡¨
- `POST /api/mcp_tools/configs/` - åˆ›å»º MCP é…ç½®

- `POST /api/mcp_tools/configs/` - åˆ›å»º MCP é…ç½®

### APIå¯†é’¥ç®¡ç†
- `GET /api/api_keys/` - APIå¯†é’¥åˆ—è¡¨ (ç¤ºä¾‹, å…·ä½“æ ¹æ®api_keys.urls)
- `POST /api/api_keys/` - åˆ›å»ºAPIå¯†é’¥ (ç¤ºä¾‹, å…·ä½“æ ¹æ®api_keys.urls)

### çŸ¥è¯†åº“ç®¡ç† (æ–°å¢)
- `GET /api/knowledge/kbs/` - çŸ¥è¯†åº“åˆ—è¡¨ (ç¤ºä¾‹, å…·ä½“æ ¹æ®knowledge.urls)
- `POST /api/knowledge/kbs/` - åˆ›å»ºçŸ¥è¯†åº“ (ç¤ºä¾‹, å…·ä½“æ ¹æ®knowledge.urls)
- `POST /api/knowledge/kbs/{kb_id}/upload_docs/` - ä¸Šä¼ æ–‡æ¡£åˆ°çŸ¥è¯†åº“ (ç¤ºä¾‹)
- `GET /api/knowledge/kbs/{kb_id}/search_docs/` - æ£€ç´¢çŸ¥è¯†åº“æ–‡æ¡£ (ç¤ºä¾‹)

### API Schemaä¸æ–‡æ¡£ (æ–°å¢)
- `GET /api/schema/` - è·å– OpenAPI 3.0 Schema
- `GET /api/schema/swagger-ui/` - Swagger UI ç•Œé¢
- `GET /api/schema/redoc/` - ReDoc UI ç•Œé¢

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.8+ (æ¨è 3.10+)
- Django 5.2.1
- SQLite/PostgreSQL
- Pip (åŒ…ç®¡ç†å™¨)
- Git (ç‰ˆæœ¬æ§åˆ¶)

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd WhartTest_django
```

2. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

3. **æ•°æ®åº“è¿ç§»**
```bash
python manage.py makemigrations
python manage.py migrate
```

4. **åˆ›å»ºè¶…çº§ç”¨æˆ·**
```bash
python manage.py createsuperuser
```

5. **å¯åŠ¨æœåŠ¡**
```bash
python manage.py runserver
```

### é…ç½®è¯´æ˜

#### ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å | å¿…å¡« | é»˜è®¤å€¼ | ç¤ºä¾‹å€¼ | è¯´æ˜ |
|--------|------|--------|--------|------|
| `DJANGO_DEBUG` | å¦ | `False` | `True` | è°ƒè¯•æ¨¡å¼å¼€å…³ï¼Œå¼€å‘ç¯å¢ƒè®¾ä¸º `True`ï¼Œç”Ÿäº§ç¯å¢ƒè®¾ä¸º `False` |
| `DJANGO_SECRET_KEY` | å»ºè®®è®¾ç½® | å¼€å‘é»˜è®¤å€¼ | `your-production-secret-key-here` | Django å¯†é’¥ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½®å¼ºå¯†é’¥ |
| `DJANGO_ALLOWED_HOSTS` | ç”Ÿäº§å¿…å¡« | å¼€å‘é»˜è®¤ | `yourdomain.com,localhost,127.0.0.1` | å…è®¸çš„ä¸»æœºåˆ—è¡¨ï¼Œç”¨é€—å·åˆ†éš” |
| `DJANGO_SUPERUSER_USERNAME` | å¦ | `admin` | `admin` | Docker å®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºçš„è¶…çº§ç”¨æˆ·å |
| `DJANGO_SUPERUSER_PASSWORD` | å¦ | `123456` | `123456` | Docker å®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºçš„è¶…çº§ç”¨æˆ·å¯†ç  |
| `DJANGO_SUPERUSER_EMAIL` | å¦ | `admin@qq.com` | `admin@qq.com` | Docker å®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºçš„è¶…çº§ç”¨æˆ·é‚®ç®± |
| `DJANGO_CORS_ALLOWED_ORIGINS` | å¦ | å¼€å‘é»˜è®¤ | `http://localhost:3000,http://127.0.0.1:3000` | CORS å…è®¸çš„æºï¼Œç”¨é€—å·åˆ†éš” |
| `DJANGO_CSRF_TRUSTED_ORIGINS` | å¦ | å¼€å‘é»˜è®¤ | `http://localhost:3000,http://127.0.0.1:3000` | CSRF ä¿¡ä»»çš„æºï¼Œç”¨é€—å·åˆ†éš” |
| `USER_AGENT` | å¦ | é»˜è®¤å€¼ | `WhartTest-Django/1.0 (AI Test Case Generation Platform)` | HTTP è¯·æ±‚çš„ç”¨æˆ·ä»£ç†æ ‡è¯† |
| `DATABASE_URL` | å¦ | SQLite | `postgresql://user:pass@localhost/dbname` | æ•°æ®åº“è¿æ¥ URLï¼ˆç”Ÿäº§ç¯å¢ƒæ¨è PostgreSQLï¼‰ |
| `OPENAI_API_KEY` | å¦ | - | `sk-...` | OpenAI API å¯†é’¥ï¼ˆå¦‚æœä½¿ç”¨ OpenAI æ¨¡å‹ï¼‰ |
| `ANTHROPIC_API_KEY` | å¦ | - | `sk-ant-...` | Anthropic API å¯†é’¥ï¼ˆå¦‚æœä½¿ç”¨ Claude æ¨¡å‹ï¼‰ |

#### LLM é…ç½®
åœ¨ç®¡ç†åå°æˆ–é€šè¿‡ API é…ç½® LLM ä¾›åº”å•†å’Œ API å¯†é’¥ã€‚

#### MCP é…ç½®
é…ç½® MCP æœåŠ¡å™¨è¿æ¥ä¿¡æ¯ï¼Œæ”¯æŒæœ¬åœ°å’Œè¿œç¨‹æœåŠ¡å™¨ã€‚

## æƒé™ç³»ç»Ÿ

### æƒé™å±‚çº§
1. **ç”¨æˆ·è®¤è¯** - ç¡®ä¿ç”¨æˆ·å·²ç™»å½•
2. **æ¨¡å‹æƒé™** - Django æ¨¡å‹çº§åˆ«æƒé™
3. **é¡¹ç›®æƒé™** - åŸºäºé¡¹ç›®æˆå‘˜èº«ä»½çš„æƒé™

### è§’è‰²å®šä¹‰
- **Owner** - é¡¹ç›®æ‹¥æœ‰è€…ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™
- **Admin** - é¡¹ç›®ç®¡ç†å‘˜ï¼Œå¯ç®¡ç†é¡¹ç›®å’Œæˆå‘˜
- **Member** - é¡¹ç›®æˆå‘˜ï¼Œå¯è®¿é—®é¡¹ç›®èµ„æº

## å¼€å‘æŒ‡å—

### ä»£ç ç»“æ„
```
wharttest_django/
â”œâ”€â”€ accounts/          # ç”¨æˆ·ç®¡ç†
â”œâ”€â”€ projects/          # é¡¹ç›®ç®¡ç†
â”œâ”€â”€ testcases/         # æµ‹è¯•ç”¨ä¾‹ç®¡ç†
â”œâ”€â”€ knowledge/         # çŸ¥è¯†åº“ç®¡ç† (æ–°å¢)
â”œâ”€â”€ langgraph_integration/  # AI å¯¹è¯é›†æˆ
â”œâ”€â”€ mcp_tools/         # MCP å·¥å…·ç®¡ç†
â”œâ”€â”€ api_keys/          # API å¯†é’¥ç®¡ç†
â”œâ”€â”€ llm_config/        # LLM é…ç½®ç®¡ç† (å¯èƒ½å­˜åœ¨, æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´)
â”œâ”€â”€ wharttest_django/   # é¡¹ç›®é…ç½®
â”œâ”€â”€ docs/              # æ–‡æ¡£
â”œâ”€â”€ logs/              # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ templates/         # æ¨¡æ¿æ–‡ä»¶
```

### å¼€å‘è§„èŒƒ
- æ‰€æœ‰è§†å›¾é›†ç»§æ‰¿è‡ª `BaseModelViewSet`
- ä½¿ç”¨ç»Ÿä¸€çš„å“åº”æ ¼å¼ `UnifiedResponseRenderer`
- éµå¾ª RESTful API è®¾è®¡åŸåˆ™
- å®Œå–„çš„æƒé™æ§åˆ¶å’Œæ•°æ®éš”ç¦»

## éƒ¨ç½²æŒ‡å—

### ğŸ³ Docker éƒ¨ç½²

#### æ„å»ºé•œåƒ
```bash
# æ„å»º Docker é•œåƒ
docker build -t wharttest-django .
```

#### è¿è¡Œå®¹å™¨
```bash
# ä½¿ç”¨ç¯å¢ƒå˜é‡è¿è¡Œ
docker run -d \n  -p 8000:8000 \n  -e DJANGO_DEBUG=False \n  -e DJANGO_SECRET_KEY=your-production-secret-key \n  -e DJANGO_ALLOWED_HOSTS=yourdomain.com,localhost \n  wharttest-django

# ä½¿ç”¨ .env æ–‡ä»¶è¿è¡Œ
docker run -d -p 8000:8000 --env-file .env wharttest-django
```

#### Docker Compose
```yaml
version: '3.8'
services:
  web:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DJANGO_DEBUG=False
      - DJANGO_SECRET_KEY=${SECRET_KEY}
      - DJANGO_ALLOWED_HOSTS=yourdomain.com,localhost
    volumes:
      - ./data:/app/data
```

### ğŸš€ å¿«é€Ÿéƒ¨ç½²

#### å¼€å‘ç¯å¢ƒéƒ¨ç½²
```bash
# 1. å…‹éš†é¡¹ç›®
git clone http://code.mgdaas-int.com/MGdaas-Lab/wharttest-django.git
cd wharttest-django

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate  # Linux/Mac
# æˆ– venv\Scripts\activate  # Windows

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. æ•°æ®åº“è¿ç§»
python manage.py makemigrations
python manage.py migrate

# 5. åˆ›å»ºè¶…çº§ç”¨æˆ·
python manage.py createsuperuser

# 6. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
python manage.py runserver
```

#### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

##### æ–¹æ¡ˆ1: UbuntuæœåŠ¡å™¨è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¨èï¼‰
```bash
# 1. ç³»ç»Ÿå‡†å¤‡
sudo apt update
sudo apt install python3-pip python3-venv git

# 2. å…‹éš†é¡¹ç›®
git clone http://code.mgdaas-int.com/MGdaas-Lab/wharttest-django.git
cd wharttest-django

# 3. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv
source venv/bin/activate

# 4. å®‰è£…å®Œæ•´ä¾èµ–
pip install --upgrade pip
pip install -r requirements.txt

# 5. é…ç½®åµŒå…¥æœåŠ¡ï¼ˆä½¿ç”¨APIï¼‰
export OPENAI_API_KEY=your-api-key
# æˆ–è€…ä½¿ç”¨å…¶ä»–åµŒå…¥æœåŠ¡ï¼Œå¦‚Azure OpenAIã€Ollamaç­‰

# 6. æ•°æ®åº“é…ç½®
python manage.py makemigrations
python manage.py migrate
python manage.py createsuperuser

# 7. æ”¶é›†é™æ€æ–‡ä»¶
python manage.py collectstatic --noinput

# 8. å¯åŠ¨ç”Ÿäº§æœåŠ¡å™¨
gunicorn wharttest_django.wsgi:application --bind 0.0.0.0:8000 --workers 4
```

##### æ–¹æ¡ˆ2: Docker Composeéƒ¨ç½²ï¼ˆæ¨èï¼‰
```bash
# åˆ›å»ºdocker-compose.yml  
cat > docker-compose.yml << 'EOF'
version: '3.8'
services:
  # Djangoåº”ç”¨
  django-app:
    build: .
    ports:
      - "8000:8000"
    environment:
      - OPENAI_API_KEY=your-api-key
      # æˆ–ä½¿ç”¨å…¶ä»–åµŒå…¥æœåŠ¡é…ç½®
    restart: unless-stopped
EOF

# å¯åŠ¨æœåŠ¡
docker-compose up -d
```

### ğŸ”§ ç¯å¢ƒé…ç½®

#### ç¯å¢ƒå˜é‡é…ç½®
åˆ›å»º `.env` æ–‡ä»¶ï¼š
```bash
# åŸºç¡€é…ç½®
DEBUG=False
SECRET_KEY=your-secret-key-here
ALLOWED_HOSTS=your-domain.com,your-ip-address

# æ•°æ®åº“é…ç½®ï¼ˆç”Ÿäº§ç¯å¢ƒæ¨èPostgreSQLï¼‰
DATABASE_URL=postgresql://user:password@localhost/dbname

# LLM API Keys (æ ¹æ®å®é™…ä½¿ç”¨çš„æ¨¡å‹é…ç½®)
OPENAI_API_KEY=your_openai_api_key_here
# ANTHROPIC_API_KEY=your_anthropic_api_key_here
# ... å…¶ä»– LLM API Keys

# CORSé…ç½®
DJANGO_CORS_ALLOWED_ORIGINS=http://localhost:3000,https://your-frontend-domain.com
```

#### æ•°æ®åº“é…ç½®
```python
# settings.py - ç”Ÿäº§ç¯å¢ƒæ•°æ®åº“é…ç½®
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'wharttest_db',
        'USER': 'wharttest_user',
        'PASSWORD': 'your_password',
        'HOST': 'localhost',
        'PORT': '5432',
    }
}
```

### ğŸŒ WebæœåŠ¡å™¨é…ç½®

#### Nginxé…ç½®
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_read_timeout 300s;
        proxy_connect_timeout 75s;
    }

    location /static/ {
        alias /path/to/your/static/files/;
        expires 30d;
    }

    location /media/ {
        alias /path/to/your/media/files/;
        expires 30d;
    }
}
```

#### SSLè¯ä¹¦é…ç½®
```bash
# ä½¿ç”¨Let's Encryptå…è´¹SSLè¯ä¹¦
sudo apt install certbot python3-certbot-nginx
sudo certbot --nginx -d your-domain.com
```



### ğŸ“Š æ€§èƒ½ä¼˜åŒ–

#### åµŒå…¥æœåŠ¡é€‰æ‹©å¯¹æ¯”
| æœåŠ¡ç±»å‹ | ç²¾åº¦ | æˆæœ¬ | éƒ¨ç½²å¤æ‚åº¦ | æ•°æ®éšç§ |
|---------|------|------|-----------|---------|
| OpenAI API | 90-95% | æŒ‰é‡ä»˜è´¹ | ç®€å• | äº‘ç«¯ |
| Azure OpenAI | 90-95% | ä¼ä¸šå®šä»· | ç®€å• | ä¼ä¸šçº§ |
| Ollamaæœ¬åœ° | 80-90% | å…è´¹ | ä¸­ç­‰ | å®Œå…¨ç§æœ‰ |

#### ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–å»ºè®®
1. **é€‰æ‹©åˆé€‚åµŒå…¥æœåŠ¡**: æ ¹æ®ç²¾åº¦ã€æˆæœ¬ã€éšç§è¦æ±‚é€‰æ‹©
2. **é…ç½®Gunicorn**: å¤šè¿›ç¨‹å¤„ç†æå‡å¹¶å‘æ€§èƒ½
3. **å¯ç”¨Nginxç¼“å­˜**: é™æ€æ–‡ä»¶ç¼“å­˜å‡å°‘æœåŠ¡å™¨è´Ÿè½½
4. **æ•°æ®åº“ä¼˜åŒ–**: ä½¿ç”¨PostgreSQLå¹¶é…ç½®è¿æ¥æ± 
5. **ç›‘æ§é…ç½®**: é…ç½®æ—¥å¿—å’Œæ€§èƒ½ç›‘æ§
6. **æœåŠ¡é¢„çƒ­**: å¯åŠ¨æ—¶é¢„åŠ è½½åµŒå…¥æœåŠ¡å‡å°‘é¦–æ¬¡æŸ¥è¯¢å»¶è¿Ÿ

### ğŸ” éƒ¨ç½²éªŒè¯

#### éªŒè¯åµŒå…¥æœåŠ¡çŠ¶æ€
å¯åŠ¨æœåŠ¡åï¼ŒæŸ¥çœ‹æ—¥å¿—ç¡®è®¤åµŒå…¥æœåŠ¡è¿æ¥æ­£å¸¸ï¼š
```bash
# OpenAI APIæœåŠ¡çš„æ—¥å¿—
ğŸš€ åˆå§‹åŒ–OpenAIåµŒå…¥æ¨¡å‹: text-embedding-ada-002
âœ… åµŒå…¥æ¨¡å‹æµ‹è¯•æˆåŠŸ: openai_text-embedding-ada-002, ç»´åº¦: 1536
ğŸ‰ è¯´æ˜: ä½¿ç”¨OpenAIåµŒå…¥APIæœåŠ¡
```

#### æœåŠ¡å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥Django API
curl http://localhost:8000/api/knowledge/embedding-services/  

# æ£€æŸ¥çŸ¥è¯†åº“ç³»ç»Ÿ
python manage.py check_knowledge_system --verbose
```

#### åŠŸèƒ½æµ‹è¯•
```bash
# æµ‹è¯•APIæ¥å£
curl -X GET http://localhost:8000/api/projects/ \
  -H "Authorization: Bearer YOUR_JWT_TOKEN"

# æµ‹è¯•AIå¯¹è¯åŠŸèƒ½
curl -X POST http://localhost:8000/api/lg/chat/ \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{"message": "å¸®æˆ‘ç”Ÿæˆä¸€ä¸ªç™»å½•åŠŸèƒ½çš„æµ‹è¯•ç”¨ä¾‹", "project_id": 1}'
```

### ğŸ›¡ï¸ å®‰å…¨é…ç½®

#### é˜²ç«å¢™è®¾ç½®
```bash
# Ubuntu UFWé˜²ç«å¢™é…ç½®
sudo ufw allow 22    # SSH
sudo ufw allow 80    # HTTP
sudo ufw allow 443   # HTTPS
sudo ufw enable
```

#### å®‰å…¨æ£€æŸ¥æ¸…å•
- [ ] æ›´æ”¹é»˜è®¤å¯†ç å’Œå¯†é’¥
- [ ] é…ç½®HTTPS/SSLè¯ä¹¦
- [ ] è®¾ç½®é˜²ç«å¢™è§„åˆ™
- [ ] é…ç½®æ•°æ®åº“è®¿é—®æƒé™
- [ ] å¯ç”¨æ—¥å¿—ç›‘æ§
- [ ] å®šæœŸå¤‡ä»½æ•°æ®

### ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

#### åŸºç¡€ç¯å¢ƒ
- [ ] Python 3.8+ å·²å®‰è£…
- [ ] è™šæ‹Ÿç¯å¢ƒå·²åˆ›å»ºå¹¶æ¿€æ´»
- [ ] requirements.txt ä¾èµ–å·²å®‰è£…
- [ ] æ•°æ®åº“å·²é…ç½®å¹¶è¿ç§»
- [ ] è¶…çº§ç”¨æˆ·å·²åˆ›å»º

#### AIåŠŸèƒ½
- [ ] HuggingFaceæ¨¡å‹å·²ä¸‹è½½ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
- [ ] å‘é‡æ¨¡å‹åŠ è½½çŠ¶æ€å·²éªŒè¯
- [ ] çŸ¥è¯†åº“åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] AIå¯¹è¯æ¥å£æµ‹è¯•é€šè¿‡

#### ç”Ÿäº§ç¯å¢ƒ
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] é™æ€æ–‡ä»¶å·²æ”¶é›†
- [ ] WebæœåŠ¡å™¨å·²é…ç½®
- [ ] SSLè¯ä¹¦å·²å®‰è£…
- [ ] é˜²ç«å¢™å·²è®¾ç½®
- [ ] ç›‘æ§å’Œæ—¥å¿—å·²é…ç½®
- [ ] å¤‡ä»½ç­–ç•¥å·²å®æ–½

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

### åè®®è¯´æ˜
- âœ… **å•†ä¸šä½¿ç”¨** - å¯ç”¨äºå•†ä¸šé¡¹ç›®
- âœ… **ä¿®æ”¹** - å¯ä»¥ä¿®æ”¹æºä»£ç 
- âœ… **åˆ†å‘** - å¯ä»¥åˆ†å‘åŸå§‹æˆ–ä¿®æ”¹åçš„ä»£ç 
- â— **è´£ä»»** - ä½œè€…ä¸æ‰¿æ‹…è´£ä»»
- â— **ä¿è¯** - ä¸æä¾›ä»»ä½•ä¿è¯

### ä½¿ç”¨è¦æ±‚
ä½¿ç”¨æœ¬é¡¹ç›®æ—¶ï¼Œè¯·åœ¨æ‚¨çš„é¡¹ç›®ä¸­åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
- ä¿ç•™åŸå§‹çš„ç‰ˆæƒå£°æ˜
- ä¿ç•™MITè®¸å¯è¯å…¨æ–‡

### ç¬¬ä¸‰æ–¹ä¾èµ–
æœ¬é¡¹ç›®ä½¿ç”¨çš„ä¸»è¦ä¾èµ–åº“åŠå…¶åè®®ï¼š
- Django (BSD-3-Clause)
- Django REST Framework (MIT)
- LangChainç³»åˆ— (MIT)
- HuggingFace Transformers (Apache-2.0)
- å…¶ä»–ä¾èµ–åº“è¯¦è§ [requirements.txt](requirements.txt)

æ‰€æœ‰ä¾èµ–åº“å‡ä¸ºå®½æ¾å¼€æºåè®®ï¼Œä¸MITåè®®å®Œå…¨å…¼å®¹ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- æäº¤ Issue
- é¡¹ç›®è®¨è®ºåŒº

---

**WhartTest** - AIé©±åŠ¨æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆï¼Œè®©æµ‹è¯•æ›´æ™ºèƒ½ï¼Œè®©å¼€å‘æ›´é«˜æ•ˆï¼
